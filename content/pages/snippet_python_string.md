---
title: 'Python での文字列リテラル'
date: '2023-07-12'
description: 'Python で文字列リテラルを宣言する方法についてサンプルコードともにまとめました'
tags:
  - Python
keywords:
  - Python
  - String
---

Python では文字列を扱うことができます。
本記事では、ソースコード中で文字列を表記する方法、つまり、
文字列 [リテラル](https://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%86%E3%83%A9%E3%83%AB) を宣言する方法についてまとめました。


文字列リテラルを宣言する
====

文字列 [リテラル](https://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%86%E3%83%A9%E3%83%AB) を定義するには、
シングルコーテーション (`'`) またはダブルコーテーション (`"`) で囲います。

```python
s = "Hello, World."

print(s)
```

```console
Hello, World.
```

シングルコーテーションで囲った場合は文中にダブルコーテーション (") が入れられ、
逆に、ダブルコーテーションは文中にシングルコーテーション (') が入れられます。
また、シングルコーテーションでもダブルコーテーションでも、バックスラッシュでエスケープできます。

```python
print('シングルコーテーションは文中にダブルコーテーション (") が入れられます')
print("逆に、ダブルコーテーションは文中にシングルコーテーション (') が入れられます")

print('シングルコーテーション (\") ではエスケープ文字が使えます\n')
print("ダブルコーテーション (\') でも使えます\n")
```

```console
シングルコーテーションは文中にダブルコーテーション (") が入れられます
逆に、ダブルコーテーションは文中にシングルコーテーション (') が入れられます
シングルコーテーション (") ではエスケープ文字が使えます

ダブルコーテーション (') でも使えます
```

使用可能なエスケープは C 言語のものと似ています。
詳細は [リファレンス記載の表](https://docs.python.org/ja/3/reference/lexical_analysis.html#strings) を参照してください。

複数行の文字列リテラルを宣言する
---

シングルコーテーションやダブルコーテーションで囲う場合、直接改行を記述することはできません。
つまり、以下はエラーとなります。

```python
s = "
改行を
直接
記述できません
"
```

改行を直接記述するためには
三重引用符、シングルコーテーション (') 3 つまたはダブルコーテーション (") 3 つで囲います。

この表記方法は複数行の文字列を扱いたい時によく用いられます。

```python
print('''三重引用符について
三重引用符はシングルコーテーション (') 3 つまたは
ダブルコーテーション (") 3 つで囲います。

この表記方法は複数行の文字列を扱いたい時によく用いられます。
''')


print("""このようにダブルコーテーションも使うことができます""")

print("""\
このように、エスケープシーケンス \\(改行) を組み合わせることで、最初の改行を無視させることができます
""")
```

```console
三重引用符について
三重引用符はシングルコーテーション (') 3 つまたは
ダブルコーテーション (") 3 つで囲います。

この表記方法は複数行の文字列を扱いたい時によく用いられます。

このようにダブルコーテーションも使うことができます
このように、エスケープシーケンス \(改行) を組み合わせることで、最初の改行を無視させることができます
```

エスケープシーケンスを無効にした文字列リテラル (raw string literal) を宣言する
----

エスケープシーケンスを無効にしたい場合、つまり `\` をそのまま記述したい場合は、接頭辞 `r` を付与して
明示的に raw string として記すことができます。

```python
r = r'これは raw string なので \n と直接記述できます'
print(r)
```

```console
これは raw string なので \n と直接記述できます
```

文字列ではなく、バイナリシーケンスのリテラルを宣言する
----

そのほかの接頭辞として、 `b`, `f` や `u` があります。

接頭辞 `b` は、文字列をバイトシーケンスとして記述します。詳細については後述します。

```python
b = b'this literal be a Binary Sequence'
debug(b)
debug(b[0])
```

```console
b'this literal be a Binary Sequence'
116
```

変数を埋め込んだ文字列リテラル (formatted string literal) を宣言する
----

接頭辞 `f` は、フォーマット済み文字列リテラルを表し、他の変数の値を埋め込んだりするときに用います。
詳細については別記事にて解説します。

```python
s = 'is it ok?'
f = f'formatted {s}'
print(f)
```

```console
formatted is it ok?
```

Python 2.X との後方互換性のための接頭辞 `u`
----

接頭辞 `u` は、 Python 2.X との後方互換性のために用意されました。
Python 2.X では、Unicode文字列を表すリテラルとして `u` 接頭辞が用いられましたが、 Python 3.X では最初から文字列は Unicode 文字列です。
ですが、 Python 2.X のプログラムを Python 3.X で動かすために、通常のリテラルと変わらない接頭辞 `u` を用意しています。
つまり、以下は同じリテラルの定義を表します。

```python
s1 = u'Python 2.X では、Unicode 文字列を表すために u が用いられました'
print(s1)

s2 = 'Python 2.X では、Unicode 文字列を表すために u が用いられました'

print(s1 == s2)
```

```console
Python 2.X では、Unicode 文字列を表すために u が用いられました
True
```

テキストシーケンス型
----

Python の文字列は [str型](https://docs.python.org/ja/3/library/stdtypes.html#str) です。
str 型は Unicode コードポイントのイミュータブルなシーケンスです。

シーケンスなので、 Python のシーケンスへのアクセス方法などで、文字列を切り出すことができます。

```python
s = "Hello, World."
print(s[0:5])
```

```console
Hello
```

また、１文字を表す専用のクラスはなく、１文字でも str です。
つまり `s[0] == s[0:1]` となります。

```python
s = "Hello, World."
print(s[0])
print(s[0:1])
print(s[0] == s[0:1])
```

```console
H
H
True
```

文字列リテラルはイミュータブル、つまり不変です。ですので、内容を書き換えることはできません。
例えば、以下のように特定の文字を書き換えようとするとエラーになります。

```python
s = "Hello, World."
s[3] = "a"
```

バイナリシーケンス型
---

バイナリを操作するための型として `bytes` と `bytearray` が用意されており、前者はイミュータブル、後者はミュータブルです。

`bytes` は各値が 8 ビットの値、つまり 0 <= x < 256 に収まるような整数のシーケンスです。
要は、[バイト](https://ja.wikipedia.org/wiki/%E3%83%90%E3%82%A4%E3%83%88_(%E6%83%85%E5%A0%B1)) のシーケンスです。

リテラルを宣言するときに ASCII 文字列を使用することができます。

```python
b = b'This is bytes'
print(b.__class__)
print(b)
```

```console
bytes
b'This is bytes'
```

あらかたの値は [ASCII コード表](https://e-words.jp/p/r-ascii.html) を見れば入力できるかと思います。

`bytes` の値をデバッグ用に `print` したりした場合、python は ASCII 文字列として各値を出力しますが、
実際には、たとえば `\x08` (バックスペース) など表示できない値が入っているケースもあるので注意してください。

```python
b= b"\x41\x42\x43"
print(b)
print(len(b))
b= b"\x41\x42\x08\x43"
print(b)
print(len(b))
```

```console
b'ABC'
3
b'AB\x08C'
4
```

ところで、 `bytes` は不変でした。ですので、とある１要素を変更することはできません。
可変のバイナリシーケンスを使いたい場合は `bytearray` を使用してください。

参考
====

https://docs.python.org/3/library/stdtypes.html#text-sequence-type-str
https://docs.python.org/3/reference/lexical_analysis.html#string-and-bytes-literals
