<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>カレンダー作成問題の解答 Go言語編 | ayasuda.github.io</title><meta name=keywords content="Go,プログラミング問題,カレンダー"><meta name=description content="初心者向けプログラミング問題の１つである「カレンダー作成問題」の解答コードと作り方をメモしていきます。"><meta name=author content="ayasuda"><link rel=canonical href=https://ayasuda.github.io/pages/answer_calendar_go/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ayasuda.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ayasuda.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ayasuda.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ayasuda.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ayasuda.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-138223597-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="カレンダー作成問題の解答 Go言語編"><meta property="og:description" content="初心者向けプログラミング問題の１つである「カレンダー作成問題」の解答コードと作り方をメモしていきます。"><meta property="og:type" content="article"><meta property="og:url" content="https://ayasuda.github.io/pages/answer_calendar_go/"><meta property="article:section" content="pages"><meta property="article:published_time" content="2019-05-06T00:00:00+00:00"><meta property="article:modified_time" content="2019-05-06T00:00:00+00:00"><meta property="og:site_name" content="ayasuda.gihtub.io"><meta name=twitter:card content="summary"><meta name=twitter:title content="カレンダー作成問題の解答 Go言語編"><meta name=twitter:description content="初心者向けプログラミング問題の１つである「カレンダー作成問題」の解答コードと作り方をメモしていきます。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Pages","item":"https://ayasuda.github.io/pages/"},{"@type":"ListItem","position":3,"name":"カレンダー作成問題の解答 Go言語編","item":"https://ayasuda.github.io/pages/answer_calendar_go/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"カレンダー作成問題の解答 Go言語編","name":"カレンダー作成問題の解答 Go言語編","description":"初心者向けプログラミング問題の１つである「カレンダー作成問題」の解答コードと作り方をメモしていきます。","keywords":["Go","プログラミング問題","カレンダー"],"articleBody":"アウトプットのネタに困ったらこれ！？Ruby初心者向けのプログラミング問題を集めてみた（全10問） で紹介された問題を解いてみようと思いました。\nプログラマー歴1x年目。最近は手癖でプログラムを書いているので、意外にこの手の問題が解けなくなっているかもしれない……\nなお、本記事では解答例は記事の最後に記します。 記事の冒頭で問題の紹介を抜粋します。次に、実装手順をつらつらと書いていきます。 ほら、いざって時には解答例じゃなくて、そこに至る手順が大事になることも多いですし。お寿司。 なお、今回は Go 言語を用いて解答していきたいと思います。 最後に解答例と発展例を示していきます。\nカレンダー作成問題 カレンダーを表示するプログラム実装で、問題自体は「たのしいRuby」に記載されているとのことです。\nDate クラスを使って、今月の１日と月末の日付と曜日を求め、次のような形式でカレンダーを表示させてください。\nApril 2013 Su Mo Tu We Th Fr Sa 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 cal コマンドの再実装ですね！\n手順 ポイントは日付処理用のライブラリの使い方です。問題文にヒントそのものが出ていますが、 今月の１日が何曜日なのかと、今月の最後の日付がわかれば多分できるでしょう。\n今日の日付と time ライブラリ さて、Go 言語で日付時刻を取り扱うなら time パッケージです。 なお、このパッケージはグレゴリオ暦が想定されており、また閏秒は想定されていません。 （ですので、この問題が「天保暦のカレンダーを表示せよ」とかだと対応できませんね笑）\nまずはいつものコードを書いていきましょう。\npackage main import \"fmt\" func main() { fmt.Plintln(\"vim-go\") } 早速、今日の日付と月末月初を表示してみましょう。\nひとまず、 time.Now() で現時刻が取得できます。\nfunc Now() Time\nこの関数は Time型 を返します。この型はナノ秒単位での時刻を保持しているので 呼び出したタイミングによって値は異なります。\n次のコードで実験してみましょう。\npackage main import ( \"fmt\" \"time\" ) func main() { fmt.Plintln(time.Now()) fmt.Plintln(time.Now()) } このコードを実行した結果は次の通りです。ナノ秒の値が異なっているのがわかるかと思います。\n$ go run main.go 2019-05-05 01:04:15.881271 +0900 JST m=+0.000507473 2019-05-05 01:04:15.881415 +0900 JST m=+0.000650832 さて、 Time 型には、年月日や時間を返す func (Time) Year() int, func (t Time) Month() Month, func (t Time) Day() int, func (t Time) Hour() int や、年月日の３項目を一気に返す func (t Time) Date() (year int, month Month, day int) などが用意されています。 なお、 Month 型は type Month int ですので、下記のコードは true になります。\ntime.Febrary == 2 // true time.November == 5 // false 月初に関してはこれらの関数の組み合わせと、 time.Date を組み合わせると取得できそうです。\nfunc Date(year int, month Month, day, hour, min, sec, nsec int, loc *Location) Time\n月末の求め方 1: time.Date を使う 月末に関してはどうでしょう？ 月の日数は月によって違います。また２月は閏年かどうかによって異なります。 この辺のコードを愚直に書くとこんな感じになります。\npackage main import ( \"fmt\" \"time\" ) func main() { n := time.Now() f := time.Date(n.Year(), n.Month(), 1, 0, 0, 0, 0, time.Local) // 月初 l := time.Date(n.Year(), n.Month(), lastDay(n), 0, 0, 0, 0, time.Local) // 月末 fmt.Println(n) fmt.Println(f) fmt.Println(l) } // lastDay は月末の日付を数値で返します func lastDay(t time.Time) int { switch t.Month() { case time.January, time.March, time.May, time.July, time.August, time.October, time.December: return 31 case time.April, time.June, time.September, time.November: return 30 case time.February: if IsLeapYear(t) { return 29 } else { return 28 } default: return 1 } } // IsLeapYear は閏年なら true を返します func IsLeapYear(t time.Time) bool { y := time.Date(t.Year(), time.December, 31, 0, 0, 0, 0, time.Local) days := y.YearDay() if days \u003e 365 { return true } else { return false } } 月末の求め方 2: time.Add を使い、次の月の月初から1日マイナスする 月末の日付を求めるやり方の別解として、次の月の月初から１日マイナスするという方法もあるでしょう。 この場合は、現在時刻が12月の場合だけ気をつける必要があります。\nまた、日付の加算・減算には func (t Time) Add(d Duration) Time を使います。\npackage main import ( \"fmt\" \"time\" ) func main() { n := time.Now() f := time.Date(n.Year(), n.Month(), 1, 0, 0, 0, 0, time.Local) l := lastDay(n) fmt.Println(n) fmt.Println(f) fmt.Println(l) } // lastDay は指定月の最終日を返します。 func lastDay(n time.Time) time.Time { var f time.Time if n.Month() == time.November { f = time.Date(n.Year()+1, time.January, 1, 0, 0, 0, 0, time.Local) } else { f = time.Date(n.Year(), n.Month()+1, 1, 0, 0, 0, 0, time.Local) } return f.Add(time.Hour * 24 * -1) } 個人的には後者のコードの方がスッキリしていて良いと思います。\n月初は何曜日？ 実に単純ですが、func (t Time) Weekday() Weekday を使います。 なお、 Weekday 型は type Weekday int です。\n表示部分を作っていこう あとは、表示部分を作っていくだけです。 ただただ愚直に作るので、記事としてはあまり面白くないかもしれません笑\n年・月表記とセンタリング 月名の表示は func (m Month) String() string を使えばすぐにできます。 また今回のプログラムでは、表示の横幅が次の通り、Su Mo Tu We Th Fr Sa 20 文字で固定です。 ですので、月名の長さを n とすると、 (20 - (n + 5)) / 2 個のスペースを左側に挿入すると、いい感じにセンタリングできるはずです。 そんなわけで、最初の月名表示の部分は下記の様なコードになります。\npackage main import ( \"fmt\" \"strings\" \"time\" ) func main() { n := time.Now() ms := n.Month().String() ls := (20 - (len(ms) + 5)) / 2 fmt.Printf(\"%s%s %d\\n\", strings.Repeat(\" \", ls), ms, n.Year()) } カレンダー表示部分 この部分も愚直にやっていくのが良いでしょう。\n今回の私は、 1 から日数分のループを回すことをベースに実装しました。 その際、最初の週の左インデントの量を月初の曜日によって変えつつ、 どのタイミングで改行を挟むかも月初の曜日によって変えるコードを用意しました。\n最終的な実装例は、以下の通りとなります。\n解答例 ソースコードは こちら にあります。\npackage main import ( \"fmt\" \"strings\" \"time\" ) func main() { n := time.Now() f := time.Date(n.Year(), n.Month(), 1, 0, 0, 0, 0, time.Local) l := lastDay(n) ms := n.Month().String() ls := (15 - len(ms)) / 2 fmt.Printf(\"%s%s %d\\n\", strings.Repeat(\" \", ls), ms, n.Year()) var idt, cnt int switch f.Weekday() { case time.Sunday: idt = 0 cnt = 6 case time.Monday: idt = 3 cnt = 5 case time.Tuesday: idt = 6 cnt = 4 case time.Wednesday: idt = 9 cnt = 3 case time.Thursday: idt = 12 cnt = 2 case time.Friday: idt = 15 cnt = 1 case time.Saturday: idt = 18 cnt = 0 } fmt.Println(\"Su Mo Tu We Th Fr Sa\") fmt.Printf(\"%s\", strings.Repeat(\" \", idt)) for i := 1; i \u003c= l.Day(); i++ { if i \u003c 10 { fmt.Printf(\" %d\", i) } else { fmt.Printf(\"%d\", i) } if cnt \u003c= 0 { fmt.Printf(\"\\n\") cnt = 6 } else { fmt.Printf(\" \") cnt-- } } fmt.Printf(\"\\n\") } func lastDay(n time.Time) time.Time { var f time.Time if n.Month() == time.November { f = time.Date(n.Year()+1, time.January, 1, 0, 0, 0, 0, time.Local) } else { f = time.Date(n.Year(), n.Month()+1, 1, 0, 0, 0, 0, time.Local) } return f.Add(time.Hour * 24 * -1) } 発展例に向けて 今回のカレンダー問題は、 cal コマンドの簡易実装そのものです。ですので、実際の cal コマンド実装が大変参考になります。 また、cal コマンドのオプションを自前で実装してみるのも勉強になるでしょう。\n以下、個人的に興味深かった cal コマンドの現実の実装例を抜粋して紹介してみたいと思います。\nlinux での cal 実装は下記にあります。\nhttps://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c\nこの実装では、月の日数を割とハードコード目に実装しているのが興味深いです。\nhttps://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c#L193\nstatic const int days_in_month[2][13] = { {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31}, {0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31}, }; カレンダー部分の表示では、複数月の表示に対応したコードが書かれています。 809行目からの１週当たりの表示部分は鮮やかですね。\nhttps://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c#L787\nFreeBSD での実装は以下にあります\nhttps://github.com/freebsd/freebsd/blob/master/usr.bin/ncal/ncal.c\n年単位での表示がサポートされているので大変そうです笑\nちなみに、 macOS とかで cal コマンドを CAL と呼ぶと縦横が転置して表示されますよね？\n$ cal 5月 2019 日 月 火 水 木 金 土 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 $ CAL 5月 2019 月 6 13 20 27 火 7 14 21 28 水 1 8 15 22 29 木 2 9 16 23 30 金 3 10 17 24 31 土 4 11 18 25 日 5 12 19 26 この辺の動きは\n/* * Get the filename portion of argv[0] and set flag_backward if * this program is called \"cal\". */ if (strncmp(basename(argv[0]), \"cal\", strlen(\"cal\")) == 0) flag_backward = 1; https://github.com/freebsd/freebsd/blob/master/usr.bin/ncal/ncal.c#L249\nにある通り、 cal という名前で呼び出さなかった時に、 cal -N をつけた時と同じ動きになる実装通りですね！\n","wordCount":"2741","inLanguage":"en","datePublished":"2019-05-06T00:00:00Z","dateModified":"2019-05-06T00:00:00Z","author":{"@type":"Person","name":"ayasuda"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ayasuda.github.io/pages/answer_calendar_go/"},"publisher":{"@type":"Organization","name":"ayasuda.github.io","logo":{"@type":"ImageObject","url":"https://ayasuda.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ayasuda.github.io accesskey=h title="ayasuda.github.io (Alt + H)">ayasuda.github.io</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ayasuda.github.io/pages/ title=Posts><span>Posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ayasuda.github.io>Home</a>&nbsp;»&nbsp;<a href=https://ayasuda.github.io/pages/>Pages</a></div><h1 class=post-title>カレンダー作成問題の解答 Go言語編</h1><div class=post-description>初心者向けプログラミング問題の１つである「カレンダー作成問題」の解答コードと作り方をメモしていきます。</div><div class=post-meta><span title='2019-05-06 00:00:00 +0000 UTC'>2019-05-06</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;2741 words&nbsp;·&nbsp;ayasuda</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#今日の日付と-time-ライブラリ>今日の日付と time ライブラリ</a></li><li><a href=#月末の求め方-1-timedate-を使う>月末の求め方 1: time.Date を使う</a></li><li><a href=#月末の求め方-2-timeadd-を使い次の月の月初から1日マイナスする>月末の求め方 2: time.Add を使い、次の月の月初から1日マイナスする</a></li><li><a href=#月初は何曜日>月初は何曜日？</a></li><li><a href=#表示部分を作っていこう>表示部分を作っていこう</a><ul><li><a href=#年月表記とセンタリング>年・月表記とセンタリング</a></li><li><a href=#カレンダー表示部分>カレンダー表示部分</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><a href=https://blog.jnito.com/entry/2019/05/03/121235>アウトプットのネタに困ったらこれ！？Ruby初心者向けのプログラミング問題を集めてみた（全10問）</a>
で紹介された問題を解いてみようと思いました。</p><p>プログラマー歴1x年目。最近は手癖でプログラムを書いているので、意外にこの手の問題が解けなくなっているかもしれない……</p><p>なお、本記事では解答例は記事の最後に記します。
記事の冒頭で問題の紹介を抜粋します。次に、実装手順をつらつらと書いていきます。
ほら、いざって時には解答例じゃなくて、そこに至る手順が大事になることも多いですし。お寿司。
なお、今回は Go 言語を用いて解答していきたいと思います。
最後に解答例と発展例を示していきます。</p><h1 id=カレンダー作成問題>カレンダー作成問題<a hidden class=anchor aria-hidden=true href=#カレンダー作成問題>#</a></h1><p>カレンダーを表示するプログラム実装で、問題自体は「たのしいRuby」に記載されているとのことです。</p><blockquote><p>Date クラスを使って、今月の１日と月末の日付と曜日を求め、次のような形式でカレンダーを表示させてください。</p></blockquote><pre tabindex=0><code>  April 2013
Su Mo Tu We Th Fr Sa
    1  2  3  4  5  6
 7  8  9 10 11 12 13
14 15 16 17 18 19 20
21 22 23 24 25 26 27
28 29 30
</code></pre><p><code>cal</code> コマンドの再実装ですね！</p><h1 id=手順>手順<a hidden class=anchor aria-hidden=true href=#手順>#</a></h1><p>ポイントは日付処理用のライブラリの使い方です。問題文にヒントそのものが出ていますが、
今月の１日が何曜日なのかと、今月の最後の日付がわかれば多分できるでしょう。</p><h2 id=今日の日付と-time-ライブラリ>今日の日付と time ライブラリ<a hidden class=anchor aria-hidden=true href=#今日の日付と-time-ライブラリ>#</a></h2><p>さて、Go 言語で日付時刻を取り扱うなら <a href=https://golang.org/pkg/time/>time</a> パッケージです。
なお、このパッケージはグレゴリオ暦が想定されており、また閏秒は想定されていません。
（ですので、この問題が「天保暦のカレンダーを表示せよ」とかだと対応できませんね笑）</p><p>まずはいつものコードを書いていきましょう。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go:main.go data-lang=go:main.go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Plintln</span>(<span style=color:#e6db74>&#34;vim-go&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>早速、今日の日付と月末月初を表示してみましょう。</p><p>ひとまず、 <a href=https://golang.org/pkg/time/#Now>time.Now()</a> で現時刻が取得できます。</p><blockquote><p>func Now() Time</p></blockquote><p>この関数は <a href=https://golang.org/pkg/time/#Time>Time型</a> を返します。この型はナノ秒単位での時刻を保持しているので
呼び出したタイミングによって値は異なります。</p><p>次のコードで実験してみましょう。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go:main.go data-lang=go:main.go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Plintln</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>())
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Plintln</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>このコードを実行した結果は次の通りです。ナノ秒の値が異なっているのがわかるかと思います。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ go run main.go
</span></span><span style=display:flex><span>2019-05-05 01:04:15.881271 +0900 JST m=+0.000507473
</span></span><span style=display:flex><span>2019-05-05 01:04:15.881415 +0900 JST m=+0.000650832
</span></span></code></pre></div><p>さて、 <code>Time</code> 型には、年月日や時間を返す <code>func (Time) Year() int</code>, <code>func (t Time) Month() Month</code>, <code>func (t Time) Day() int</code>, <code>func (t Time) Hour() int</code>
や、年月日の３項目を一気に返す <code>func (t Time) Date() (year int, month Month, day int)</code> などが用意されています。
なお、 <code>Month</code> 型は <code>type Month int</code> ですので、下記のコードは true になります。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Febrary</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span> <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>November</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>5</span> <span style=color:#75715e>// false
</span></span></span></code></pre></div><p>月初に関してはこれらの関数の組み合わせと、 <a href=https://golang.org/pkg/time/#Date>time.Date</a> を組み合わせると取得できそうです。</p><blockquote><p>func Date(year int, month Month, day, hour, min, sec, nsec int, loc *Location) Time</p></blockquote><h2 id=月末の求め方-1-timedate-を使う>月末の求め方 1: time.Date を使う<a hidden class=anchor aria-hidden=true href=#月末の求め方-1-timedate-を使う>#</a></h2><p>月末に関してはどうでしょう？
月の日数は月によって違います。また２月は閏年かどうかによって異なります。
この辺のコードを愚直に書くとこんな感じになります。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go:main.go data-lang=go:main.go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>n</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>(), <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>(), <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>) <span style=color:#75715e>// 月初
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>l</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>(), <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>(), <span style=color:#a6e22e>lastDay</span>(<span style=color:#a6e22e>n</span>), <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>) <span style=color:#75715e>// 月末
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>f</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>l</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// lastDay は月末の日付を数値で返します
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>lastDay</span>(<span style=color:#a6e22e>t</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>) <span style=color:#66d9ef>int</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>switch</span> <span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>Month</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>January</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>March</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>May</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>July</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>August</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>October</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>December</span>:
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>31</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>April</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>June</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>September</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>November</span>:
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>February</span>:
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>IsLeapYear</span>(<span style=color:#a6e22e>t</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>29</span>
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>28</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>default</span>:
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// IsLeapYear は閏年なら true を返します
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>IsLeapYear</span>(<span style=color:#a6e22e>t</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>) <span style=color:#66d9ef>bool</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>y</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>t</span>.<span style=color:#a6e22e>Year</span>(), <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>December</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>days</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>y</span>.<span style=color:#a6e22e>YearDay</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>days</span> &gt; <span style=color:#ae81ff>365</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>	} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=月末の求め方-2-timeadd-を使い次の月の月初から1日マイナスする>月末の求め方 2: time.Add を使い、次の月の月初から1日マイナスする<a hidden class=anchor aria-hidden=true href=#月末の求め方-2-timeadd-を使い次の月の月初から1日マイナスする>#</a></h2><p>月末の日付を求めるやり方の別解として、次の月の月初から１日マイナスするという方法もあるでしょう。
この場合は、現在時刻が12月の場合だけ気をつける必要があります。</p><p>また、日付の加算・減算には <code>func (t Time) Add(d Duration) Time</code> を使います。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go:main.go data-lang=go:main.go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>n</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>(), <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>(), <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>l</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>lastDay</span>(<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>f</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>l</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// lastDay は指定月の最終日を返します。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>lastDay</span>(<span style=color:#a6e22e>n</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>) <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>f</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>() <span style=color:#f92672>==</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>November</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>f</span> = <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>()<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>January</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>)
</span></span><span style=display:flex><span>	} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>f</span> = <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>(), <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>()<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Add</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Hour</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>24</span> <span style=color:#f92672>*</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>個人的には後者のコードの方がスッキリしていて良いと思います。</p><h2 id=月初は何曜日>月初は何曜日？<a hidden class=anchor aria-hidden=true href=#月初は何曜日>#</a></h2><p>実に単純ですが、<code>func (t Time) Weekday() Weekday</code> を使います。
なお、 <code>Weekday</code> 型は <code>type Weekday int</code> です。</p><h2 id=表示部分を作っていこう>表示部分を作っていこう<a hidden class=anchor aria-hidden=true href=#表示部分を作っていこう>#</a></h2><p>あとは、表示部分を作っていくだけです。
ただただ愚直に作るので、記事としてはあまり面白くないかもしれません笑</p><h3 id=年月表記とセンタリング>年・月表記とセンタリング<a hidden class=anchor aria-hidden=true href=#年月表記とセンタリング>#</a></h3><p>月名の表示は <code>func (m Month) String() string</code> を使えばすぐにできます。
また今回のプログラムでは、表示の横幅が次の通り、<code>Su Mo Tu We Th Fr Sa</code> 20 文字で固定です。
ですので、月名の長さを <code>n</code> とすると、 <code>(20 - (n + 5)) / 2</code> 個のスペースを左側に挿入すると、いい感じにセンタリングできるはずです。
そんなわけで、最初の月名表示の部分は下記の様なコードになります。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go:main.go data-lang=go:main.go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>n</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>()
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ms</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>().<span style=color:#a6e22e>String</span>()
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ls</span> <span style=color:#f92672>:=</span> (<span style=color:#ae81ff>20</span> <span style=color:#f92672>-</span> (len(<span style=color:#a6e22e>ms</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>)) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s%s %d\n&#34;</span>, <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#a6e22e>ls</span>), <span style=color:#a6e22e>ms</span>, <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=カレンダー表示部分>カレンダー表示部分<a hidden class=anchor aria-hidden=true href=#カレンダー表示部分>#</a></h3><p>この部分も愚直にやっていくのが良いでしょう。</p><p>今回の私は、 1 から日数分のループを回すことをベースに実装しました。
その際、最初の週の左インデントの量を月初の曜日によって変えつつ、
どのタイミングで改行を挟むかも月初の曜日によって変えるコードを用意しました。</p><p>最終的な実装例は、以下の通りとなります。</p><h1 id=解答例>解答例<a hidden class=anchor aria-hidden=true href=#解答例>#</a></h1><p>ソースコードは <a href=https://github.com/ayasuda/sandbox/blob/master/go/cal/main.go>こちら</a> にあります。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go:main.go data-lang=go:main.go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>n</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>f</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>(), <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>(), <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>l</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>lastDay</span>(<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ms</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>().<span style=color:#a6e22e>String</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ls</span> <span style=color:#f92672>:=</span> (<span style=color:#ae81ff>15</span> <span style=color:#f92672>-</span> len(<span style=color:#a6e22e>ms</span>)) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s%s %d\n&#34;</span>, <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#a6e22e>ls</span>), <span style=color:#a6e22e>ms</span>, <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>idt</span>, <span style=color:#a6e22e>cnt</span> <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>switch</span> <span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Weekday</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Sunday</span>:
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>idt</span> = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>cnt</span> = <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Monday</span>:
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>idt</span> = <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>cnt</span> = <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Tuesday</span>:
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>idt</span> = <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>cnt</span> = <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Wednesday</span>:
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>idt</span> = <span style=color:#ae81ff>9</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>cnt</span> = <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Thursday</span>:
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>idt</span> = <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>cnt</span> = <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Friday</span>:
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>idt</span> = <span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>cnt</span> = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Saturday</span>:
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>idt</span> = <span style=color:#ae81ff>18</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>cnt</span> = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Su Mo Tu We Th Fr Sa&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s&#34;</span>, <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Repeat</span>(<span style=color:#e6db74>&#34; &#34;</span>, <span style=color:#a6e22e>idt</span>))
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>l</span>.<span style=color:#a6e22e>Day</span>(); <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>i</span> &lt; <span style=color:#ae81ff>10</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34; %d&#34;</span>, <span style=color:#a6e22e>i</span>)
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%d&#34;</span>, <span style=color:#a6e22e>i</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>cnt</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>cnt</span> = <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>cnt</span><span style=color:#f92672>--</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>lastDay</span>(<span style=color:#a6e22e>n</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>) <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>f</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>() <span style=color:#f92672>==</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>November</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>f</span> = <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>()<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>January</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>)
</span></span><span style=display:flex><span>	} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>f</span> = <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Date</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Year</span>(), <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Month</span>()<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Local</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>Add</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Hour</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>24</span> <span style=color:#f92672>*</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=発展例に向けて>発展例に向けて<a hidden class=anchor aria-hidden=true href=#発展例に向けて>#</a></h1><p>今回のカレンダー問題は、 <code>cal</code> コマンドの簡易実装そのものです。ですので、実際の <code>cal</code> コマンド実装が大変参考になります。
また、cal コマンドのオプションを自前で実装してみるのも勉強になるでしょう。</p><p>以下、個人的に興味深かった <code>cal</code> コマンドの現実の実装例を抜粋して紹介してみたいと思います。</p><p>linux での cal 実装は下記にあります。</p><p><a href=https://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c>https://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c</a></p><p>この実装では、月の日数を割とハードコード目に実装しているのが興味深いです。</p><p><a href=https://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c#L193>https://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c#L193</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> days_in_month[<span style=color:#ae81ff>2</span>][<span style=color:#ae81ff>13</span>] <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>},
</span></span><span style=display:flex><span>        {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>29</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>},
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>カレンダー部分の表示では、複数月の表示に対応したコードが書かれています。
809行目からの１週当たりの表示部分は鮮やかですね。</p><p><a href=https://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c#L787>https://github.com/karelzak/util-linux/blob/master/misc-utils/cal.c#L787</a></p><p>FreeBSD での実装は以下にあります</p><p><a href=https://github.com/freebsd/freebsd/blob/master/usr.bin/ncal/ncal.c>https://github.com/freebsd/freebsd/blob/master/usr.bin/ncal/ncal.c</a></p><p>年単位での表示がサポートされているので大変そうです笑</p><p>ちなみに、 macOS とかで <code>cal</code> コマンドを <code>CAL</code> と呼ぶと縦横が転置して表示されますよね？</p><pre tabindex=0><code>$ cal
      5月 2019
日 月 火 水 木 金 土
          1  2  3  4
 5  6  7  8  9 10 11
12 13 14 15 16 17 18
19 20 21 22 23 24 25
26 27 28 29 30 31

$ CAL
    5月 2019
月      6 13 20 27
火      7 14 21 28
水   1  8 15 22 29
木   2  9 16 23 30
金   3 10 17 24 31
土   4 11 18 25
日   5 12 19 26
</code></pre><p>この辺の動きは</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>  <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * Get the filename portion of argv[0] and set flag_backward if
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * this program is called &#34;cal&#34;.
</span></span></span><span style=display:flex><span><span style=color:#75715e>   */</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>if</span> (strncmp(basename(argv[<span style=color:#ae81ff>0</span>]), <span style=color:#e6db74>&#34;cal&#34;</span>, strlen(<span style=color:#e6db74>&#34;cal&#34;</span>)) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>           flag_backward <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span></code></pre></div><p><a href=https://github.com/freebsd/freebsd/blob/master/usr.bin/ncal/ncal.c#L249>https://github.com/freebsd/freebsd/blob/master/usr.bin/ncal/ncal.c#L249</a></p><p>にある通り、 <code>cal</code> という名前で呼び出さなかった時に、 <code>cal -N</code> をつけた時と同じ動きになる実装通りですね！</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ayasuda.github.io/tags/go/>Go</a></li><li><a href=https://ayasuda.github.io/tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%95%8F%E9%A1%8C/>プログラミング問題</a></li></ul><nav class=paginav><a class=prev href=https://ayasuda.github.io/pages/note_configuration_order_at_command_line/><span class=title>« Prev</span><br><span>コマンドラインツールでの設定値の優先順（設定ファイル・環境変数・コマンドライン引数）</span></a>
<a class=next href=https://ayasuda.github.io/pages/what_is_context_at_go/><span class=title>Next »</span><br><span>Go 言語 context パッケージ誕生の背景と使用方法</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://ayasuda.github.io>ayasuda.github.io</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>